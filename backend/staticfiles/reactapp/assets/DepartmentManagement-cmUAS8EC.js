import{r as l,u as f,R as e}from"./index-sDdCnybi.js";import{y as n}from"./index--077_VM5.js";import{d as s,u as y}from"./api-D3_w-X5d.js";const b=()=>{const[m,p]=l.useState([]),[E,o]=l.useState(!0),[r,i]=l.useState({name:"",code:""}),u=f();l.useEffect(()=>{(async()=>{try{(await y.getUserInfo()).role!=="registrar"&&(n.error("Unauthorized access"),u("/dashboard"))}catch(a){console.error("Role verification failed:",a)}})(),c()},[u]);const c=async()=>{try{o(!0);const t=await s.getDepartments();p(t)}catch(t){n.error(t.message||"Failed to load departments"),console.error("Fetch error:",t)}finally{o(!1)}},d=t=>{i({...r,[t.target.name]:t.target.value})},h=async t=>{t.preventDefault();try{await s.createDepartment(r),n.success("Department created successfully"),i({name:"",code:""}),await c()}catch(a){n.error(a.message||"Failed to create department. Please check your inputs.")}},g=async t=>{try{await s.deleteDepartment(t),n.success("Department deleted successfully"),await c()}catch(a){n.error(a.message||"Failed to delete department")}};return E?e.createElement("div",{className:"loading"},"Loading departments..."):e.createElement("div",{className:"dashboard-content"},e.createElement("h1",null,"Department Management"),e.createElement("div",{className:"management-container"},e.createElement("div",{className:"form-section"},e.createElement("h2",null,"Create New Department"),e.createElement("form",{onSubmit:h},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Department Name"),e.createElement("input",{type:"text",name:"name",value:r.name,onChange:d,required:!0,minLength:2,maxLength:100,placeholder:"E.g. Computer Science"})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Department Code"),e.createElement("input",{type:"text",name:"code",value:r.code,onChange:d,required:!0,minLength:2,maxLength:10,pattern:"[A-Za-z0-9]+",title:"Alphanumeric characters only",placeholder:"E.g. CS",className:"uppercase-input"})),e.createElement("button",{type:"submit",className:"submit-button"},"Create Department"))),e.createElement("div",{className:"list-section"},e.createElement("h2",null,"Existing Departments"),m.length>0?e.createElement("div",{className:"table-container"},e.createElement("table",{className:"management-table"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null,"Name"),e.createElement("th",null,"Code"),e.createElement("th",null,"Actions"))),e.createElement("tbody",null,m.map(t=>e.createElement("tr",{key:t.id},e.createElement("td",null,t.name),e.createElement("td",null,t.code),e.createElement("td",null,e.createElement("button",{onClick:()=>g(t.id),className:"delete-button"},"Delete"))))))):e.createElement("p",{className:"no-data"},"No departments found"))))};export{b as default};
