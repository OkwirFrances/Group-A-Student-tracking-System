import{r as l,u as N,R as e}from"./index-sDdCnybi.js";import{y as n}from"./index--077_VM5.js";import{c as m,d as b,u as D}from"./api-D3_w-X5d.js";const I=()=>{const[u,g]=l.useState([]),[f,h]=l.useState([]),[C,d]=l.useState(!0),[r,i]=l.useState({name:"",code:"",department_id:""}),E=N();l.useEffect(()=>{(async()=>{try{(await D.getUserInfo()).role!=="registrar"&&(n.error("Unauthorized access"),E("/dashboard"))}catch(a){console.error("Role verification failed:",a)}})(),c()},[E]);const c=async()=>{try{d(!0);const[t,a]=await Promise.all([m.getCourses(),b.getDepartments()]);g(t),h(a)}catch(t){n.error(t.message||"Failed to fetch data"),console.error("Fetch error:",t)}finally{d(!1)}},o=t=>{i({...r,[t.target.name]:t.target.value})},v=async t=>{var a,p;t.preventDefault();try{const s={name:r.name,code:r.code,department:r.department_id};await m.createCourse(s),n.success("Course created successfully"),i({name:"",code:"",department_id:""}),await c()}catch(s){console.error("Error creating course:",s),n.error(((p=(a=s.response)==null?void 0:a.data)==null?void 0:p.message)||s.message||"Failed to create course. Please check your inputs.")}},y=async t=>{try{await m.deleteCourse(t),n.success("Course deleted successfully"),await c()}catch(a){n.error(a.message||"Failed to delete course")}};return C?e.createElement("div",{className:"loading"},"Loading courses..."):e.createElement("div",{className:"dashboard-content"},e.createElement("h1",null,"Course Management"),e.createElement("div",{className:"management-container"},e.createElement("div",{className:"form-section"},e.createElement("h2",null,"Create New Course"),e.createElement("form",{onSubmit:v},e.createElement("div",{className:"form-group"},e.createElement("label",null,"Course Name"),e.createElement("input",{type:"text",name:"name",value:r.name,onChange:o,required:!0,placeholder:"E.g. Data Structures"})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Course Code"),e.createElement("input",{type:"text",name:"code",value:r.code,onChange:o,required:!0,placeholder:"E.g. CS201"})),e.createElement("div",{className:"form-group"},e.createElement("label",null,"Department"),e.createElement("select",{name:"department_id",value:r.department_id,onChange:o,required:!0},e.createElement("option",{value:""},"Select Department"),f.map(t=>e.createElement("option",{key:t.id,value:t.id},t.name)))),e.createElement("button",{type:"submit",className:"submit-button"},"Create Course"))),e.createElement("div",{className:"list-section"},e.createElement("h2",null,"Existing Courses"),u.length>0?e.createElement("div",{className:"table-container"},e.createElement("table",{className:"management-table"},e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null,"Name"),e.createElement("th",null,"Code"),e.createElement("th",null,"Department"),e.createElement("th",null,"Actions"))),e.createElement("tbody",null,u.map(t=>{var a;return e.createElement("tr",{key:t.id},e.createElement("td",null,t.name),e.createElement("td",null,t.code),e.createElement("td",null,((a=t.department)==null?void 0:a.name)||"N/A"),e.createElement("td",null,e.createElement("button",{onClick:()=>y(t.id),className:"delete-button"},"Delete")))})))):e.createElement("p",{className:"no-data"},"No courses found"))))};export{I as default};
